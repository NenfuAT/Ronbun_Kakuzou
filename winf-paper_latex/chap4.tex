\section{調理動作推定システム}
本章では本研究で作成した端末の動きを推定するシステムの構成や推定手法について述べる.

\figimage{images/system_configuration.pdf}{60}{本研究の概要図}{fig:1}

\subsection{データの収集}
本研究ではウェアラブルセンサとしてスマートウォッチを使用した.
他の候補としてセンサグローブが存在しており,
指先の動作まで取得できるが防水性がないため本研究では手首に装着可能なスマートウォッチを採用した.
スマートウォッチでセンシングを行うアプリを自作し取得した加速度・角速度を使用して推定を行う.
\subsection{推定手法}
本研究で作成した端末の動きを推定するシステムでは端末の回転量を求めて重力加速度を計算し,加速度から重力加速度を取り除き線形加速度を導出している.
線形加速度と端末の回転を組み合わせ相対座標から絶対座標での線形加速度に変換を行い,二重積分を行い移動距離を導出している.
本項では推定手法の詳細を述べる.
\subsubsection{端末の回転量}
今回は角速度と加速度にMadgwickフィルタを用いてセンサフージョンを行い回転量をクォータニオンとして導出している.
クォータニオンとは回転の量を表すもので,オイラー角や回転行列と相互に変換可能であり,
上下がわからなくなるジンバルロックという現象が発生しない特徴がある.
\subsubsection{線形加速度の導出}
求めた回転量を使用して重力加速度を導出し,加速度から重力加速度を取り除き線形加速度を導出している,
しかしこのままでは相対座標に基づいた移動なので,端末の姿勢を変化させながら動かすと異なる座標軸での移動と検出される.
そこで次の式を用いて変換を行う.
\[
\mathbf{a}_{\text{絶対}} = \mathbf{q} \cdot \mathbf{a}_{\text{相対}} \cdot \mathbf{q}^{-1}
\]
絶対座標へ変換することで端末の姿勢が変化した際にも同じ方向に対する移動として検出可能となる.

\subsubsection{移動距離の導出}
求めた絶対座標での旋回加速度を二重積分して移動距離を導出しているしかし,
このままでは誤差が蓄積しており正しい移動距離が推定できていない.

ここに図でフィルタ前と後のグラフ

そこでハイパスフィルタを用いて,誤差の軽減をしている.

\subsection{データの可視化}
3次元的な動きを扱うにあたり扱うデータが多くグラフで可視化してもわかりずらい.
そこで求めた回転と移動を3D空間での可視化を行うシステムを作成した.

ここに可視化するぞうの画像

この可視化システムによって,現実の動きとの比較が容易になり,特徴量の抽出を行いやすくなった.